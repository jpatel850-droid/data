import joblib.
import pandas as pd
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler

# Load the dataset
url = 'https://drive.google.com/uc?id=1qBkAiPPQ9bTiaY6PcDq7Tmp8DQsCyyrZ'
df = pd.read_csv(url)

# Convert categorical variables to numeric
df_encoded = pd.get_dummies(df)

target_column = 'Churn_No'

# Separate features and target variable
X = df_encoded.drop([target_column, 'Churn_Yes'], axis=1)  # Drop the target variables

# Standardize the features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Train the clustering model (using 3 clusters as an example)
kmeans = KMeans(n_clusters=3, random_state=42)
kmeans.fit(X_scaled)

# Save the trained model
joblib.dump(kmeans, 'kmeans_model.pkl')

print("Clustering model trained and saved as 'kmeans_model.pkl'")
